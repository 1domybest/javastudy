package ex04_dql;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

import connection.DBconnection;

public class SelectOneMainClass {
	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
		Connection con = null;
		PreparedStatement ps = null;
		ResultSet rs = null; //select 문의 결과 행을 저장합니다.
		try {
			con = DBconnection.getConnection();
			String sql ="SELECT no,name,department,hiredate FROM staff WHERE no = 3";
			
			ps = con.prepareStatement(sql);
			 rs = ps.executeQuery();
			 //rs에 저장된 데이터는 반드시 next() 메소드를 호출해서 꺼냅니다.
			 //next() 메소드
			 //1. 결과 행에서 순서대로 한 행씩 꺼냅니다.
			 //2. 결과 행이 존재하면 true 반환하고, 없으면 false
			if(rs.next()){
				//칼럼의 인덱스를 적어도되고 칼럼명을 적어도 조회가 가능하다.
				System.out.print("|NO : ["+rs.getInt("no")+"]      ");
				System.out.print("|NAME : ["+rs.getString("name")+"]      ");
				System.out.print("|DEPARTMENT : ["+rs.getString(3)+"]      ");				
				System.out.println("|HIREDATE : ["+rs.getDate(4)+"]      ");
			}else {
				System.out.println("검색된 행이 없습니다");
			}
		} catch (Exception e) {
			e.printStackTrace();
		}finally {
			try {
				if(ps != null) {ps.close();}
				if(con != null) {con.close();}
			} catch (Exception e) {
				e.printStackTrace();
			}
		}
	}
}
